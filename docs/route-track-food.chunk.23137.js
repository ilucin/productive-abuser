webpackJsonp([1],{"92Xb":function(t){t.exports={trackFood:"trackFood__GNzHl",trackFood_box:"trackFood_box__2nyWe",trackFood_title:"trackFood_title__2yxZ2",trackFood_tokenError:"trackFood_tokenError__1qN39",trackFood_tokenInput:"trackFood_tokenInput__h0YS6",trackFood_person:"trackFood_person__3g9lS"}},"hwI/":function(t,e,o){"use strict";function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=o("KM04"),p=o("5Iuc"),u=o("tyed"),l=o("6whb"),d=o("92Xb"),f=o.n(d),h=Object(s.h)(l.a,null),k=function(t){function e(){return n(this,t.apply(this,arguments))}return r(e,t),e.prototype.onInputKeyup=function(t){"13"===String(t.which||t.keyCode)&&this.props.applyToken(this.props.token)},e.prototype.render=function(t){var e=t.token,o=t.person,n=t.isLoading,r=t.isTokenError,a=t.updateToken,i=t.isConnecting,c=t.connectionError;return i?Object(s.h)("section",{class:f.a.trackFood},Object(s.h)("div",{class:f.a.trackFood_box},h)):Object(s.h)("section",{class:f.a.trackFood},Object(s.h)("div",{class:f.a.trackFood_box},Object(s.h)("div",{class:f.a.trackFood_title}," Food Tracker 2000 Pro "),Object(s.h)("input",{class:f.a.trackFood_tokenInput,type:"password",value:e||"",disabled:!!o||n,onInput:a,onKeyup:Object(u.a)(this,"onInputKeyup"),placeholder:"Write your token here"}),c&&Object(s.h)("div",{class:f.a.trackFood_tokenError},c),r&&Object(s.h)("div",{class:f.a.trackFood_tokenError},"Token error"),o&&Object(s.h)("div",{class:f.a.trackFood_person},"Hi ",o.firstName,"! I am here to track your food.")))},e}(s.Component),y=o("+UHd"),b=o("D9/9");o.d(e,"default",function(){return v});var _=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},v=function(t){function e(){a(this,e);var o=i(this,t.call(this));return o.state={token:localStorage.getItem("trackFoodToken"),isLoading:!1,isTokenError:!1,person:null,isConnecting:!0,connectionError:null},o}return c(e,t),e.prototype.componentWillMount=function(){var t=this;this.pa=new y.a(p.a),this.pa.connect(function(e){return t.onProductiveMessage(e)}).then(function(){return t.setState({isConnecting:!1,connectionError:null})}).catch(function(e){return t.setState({isConnecting:!1,connectionError:e})})},e.prototype.componentWillUnmount=function(){this.pa&&this.pa.disconnect(),this.paPerson&&this.paPerson.disconnect()},e.prototype.onTokenChange=function(t){this.setState({token:t.target.value})},e.prototype.onTokenApply=function(){var t=this;this.paPerson=new y.a(_({},p.a,{token:this.state.token})),this.setState({isLoading:!0}),localStorage.setItem("trackFoodToken",this.state.token),this.paPerson.fetchTokenPerson().then(function(e){return t.setState({person:e,isLoading:!1,isTokenError:!1})}).catch(function(){return t.setState({isLoading:!1,isTokenError:!0})})},e.prototype.onProductiveMessage=function(t){Object(b.a)(t);var e=this.state.person;if(e&&t.person.id===e.id&&0===t.text.indexOf("Danas sam jeo")){var o=t.text.split("Danas sam jeo")[1].trim();this.paPerson.query("time_entries",{},{method:"POST",headers:new Headers({Accept:"application/vnd.api+json","Content-Type":"application/vnd.api+json; charset=utf-8"}),body:JSON.stringify({data:{type:"time-entries",attributes:{time:30,billable_time:30,date:(new Date).toJSON().split("T")[0],note:o},relationships:{person:{data:{type:"people",id:e.id}},service:{data:{type:"services",id:p.a.foodServiceId}},approver:{data:null},task:{data:null}}}})}).then(function(){return alert(o)}).catch(function(t){return alert(t)})}},e.prototype.render=function(t,e){var o=e.token,n=e.person,r=e.isLoading,a=e.isTokenError,i=e.isConnecting,c=e.connectionError;return Object(s.h)(k,{token:o,person:n,isLoading:r,isTokenError:a,isConnecting:i,connectionError:c,updateToken:Object(u.a)(this,"onTokenChange"),applyToken:Object(u.a)(this,"onTokenApply")})},e}(s.Component)},tyed:function(t,e){"use strict";function o(t,e){for(var o=arguments.length,n=Array(o>2?o-2:0),r=2;r<o;r++)n[r-2]=arguments[r];if(t._actions=t._actions||{},!t._actions[e]){if(!t[e])throw new Error('Method "'+e+'" not found on component');t._actions[e]=function(){for(var o=arguments.length,r=Array(o),a=0;a<o;a++)r[a]=arguments[a];return t[e].apply(t,n.concat(r))}}return t._actions[e]}function n(t){for(var e=t.slice(),o=e.length;o>0;){var n=Math.floor(Math.random()*o);o--;var r=e[o];e[o]=e[n],e[n]=r}return e}function r(t,e){var o=t.indexOf(e);if(o>=0){var n=t.slice();return n.splice(o,1),n}return t.slice()}e.a=o,e.b=n,e.c=r}});
//# sourceMappingURL=route-track-food.chunk.23137.js.map