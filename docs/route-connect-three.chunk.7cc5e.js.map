{"version":3,"sources":["webpack:///route-connect-three.chunk.7cc5e.js","webpack:///./lib/connect-three.js","webpack:///./components/connect-three/index.js","webpack:///./routes/connect-three.js","webpack:///./components/connect-three/style.less?56f6"],"names":["webpackJsonp","2qR1","module","__webpack_exports__","__webpack_require__","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","TypeError","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","connectThree","p1","p2","isPlayerWinner","p","g","sign","0","currentPlayer","winner","y","x","reduce","hasZero","row","includes","map","cell","join","connect_three__classCallCheck","instance","Constructor","connect_three__possibleConstructorReturn","connect_three__inherits","defineProperty","preact_min","preact_router_es","style","style_default","n","_ref2","_ref3","_ref4","connect_three_ConnectThree","_Component","ConnectThree","this","apply","arguments","render","_ref","board","class","a","connectThree_p1","connectThree_p2","connectThree_board","config","productive_abuser","routing_message_handlers","d","connect_three_ConnectThreeRoute","ConnectThreeRoute","_this","playFor","state","isLoading","connectionError","componentWillMount","_this2","pa","connect","ev","onProductiveMessage","then","fetchChannels","channels","find","channel","tags","setState","catch","err","Error","alert","toString","componentWillUnmount","disconnect","channelId","id","fetchChannel","msg","text","toLowerCase","num","parseInt","indexOf","split","trim","person","firstName","lastName","Math","floor","postMessageToChannel","props","BmyT","exports"],"mappings":"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","file":"route-connect-three.chunk.7cc5e.js","sourcesContent":["webpackJsonp([4],{\n\n/***/ \"2qR1\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n\n// EXTERNAL MODULE: ../node_modules/preact/dist/preact.min.js\nvar preact_min = __webpack_require__(\"KM04\");\nvar preact_min_default = /*#__PURE__*/__webpack_require__.n(preact_min);\n\n// EXTERNAL MODULE: ../node_modules/preact-router/dist/preact-router.es.js\nvar preact_router_es = __webpack_require__(\"/QC5\");\n\n// EXTERNAL MODULE: ./components/connect-three/style.less\nvar style = __webpack_require__(\"BmyT\");\nvar style_default = /*#__PURE__*/__webpack_require__.n(style);\n\n// CONCATENATED MODULE: ./components/connect-three/index.js\n\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\nvar _ref2 = Object(preact_min[\"h\"])('br', null);\n\nvar _ref3 = Object(preact_min[\"h\"])('br', null);\n\nvar _ref4 = Object(preact_min[\"h\"])(\n  'h1',\n  null,\n  ' Connect three '\n);\n\nvar connect_three_ConnectThree = function (_Component) {\n  _inherits(ConnectThree, _Component);\n\n  function ConnectThree() {\n    _classCallCheck(this, ConnectThree);\n\n    return _possibleConstructorReturn(this, _Component.apply(this, arguments));\n  }\n\n  ConnectThree.prototype.render = function render(_ref) {\n    var board = _ref.board,\n        p1 = _ref.p1,\n        p2 = _ref.p2;\n\n    return Object(preact_min[\"h\"])(\n      'div',\n      { 'class': style_default.a.connectThree },\n      p1 && Object(preact_min[\"h\"])(\n        'div',\n        { 'class': style_default.a.connectThree_p1 },\n        ' ',\n        p1,\n        ' ',\n        _ref2,\n        ' X '\n      ),\n      p2 && Object(preact_min[\"h\"])(\n        'div',\n        { 'class': style_default.a.connectThree_p2 },\n        ' ',\n        p2,\n        ' ',\n        _ref3,\n        ' O '\n      ),\n      board ? Object(preact_min[\"h\"])(\n        'div',\n        { 'class': style_default.a.connectThree_board },\n        Object(preact_min[\"h\"])(\n          'pre',\n          null,\n          board\n        )\n      ) : _ref4\n    );\n  };\n\n  return ConnectThree;\n}(preact_min[\"Component\"]);\n\n\n// EXTERNAL MODULE: ./lib/config.js\nvar config = __webpack_require__(\"5Iuc\");\n\n// EXTERNAL MODULE: ./lib/productive-abuser.js\nvar productive_abuser = __webpack_require__(\"+UHd\");\n\n// CONCATENATED MODULE: ./lib/connect-three.js\nfunction connectThree(p1, p2) {\n  var g = [[0, 0, 0], [0, 0, 0], [0, 0, 0]];\n  var sign = { 0: ' ' };\n  sign[p1] = 'X';\n  sign[p2] = 'O';\n\n  var currentPlayer = p1;\n  var winner = void 0;\n\n  function isPlayerWinner(p) {\n    return g[0][0] === p && g[0][1] === p && g[0][2] === p || g[1][0] === p && g[1][1] === p && g[1][2] === p || g[2][0] === p && g[2][1] === p && g[2][2] === p || g[0][0] === p && g[1][0] === p && g[2][0] === p || g[0][1] === p && g[1][1] === p && g[2][1] === p || g[0][2] === p && g[1][2] === p && g[2][2] === p || g[0][0] === p && g[1][1] === p && g[2][2] === p || g[0][2] === p && g[1][1] === p && g[2][0] === p;\n  }\n\n  return function play(p, y, x) {\n    if (g[x][y] === 0 && p === currentPlayer && !winner) {\n      g[x][y] = p;\n      currentPlayer = p === p1 ? p2 : p1;\n    }\n\n    winner = isPlayerWinner(p1) ? p1 : isPlayerWinner(p2) && p2;\n    if (winner) {\n      return 'Winner is ' + winner;\n    } else if (!g.reduce(function (hasZero, row) {\n      return hasZero || row.includes(0);\n    }, false)) {\n      return 'Nobody wins';\n    }\n\n    return '-------\\n' + g.map(function (row) {\n      return '|' + row.map(function (cell) {\n        return sign[cell];\n      }).join('|') + '|';\n    }).join('\\n') + '\\n-------';\n  };\n}\n// EXTERNAL MODULE: ./lib/routing-message-handlers.js\nvar routing_message_handlers = __webpack_require__(\"D9/9\");\n\n// CONCATENATED MODULE: /usr/local/lib/node_modules/preact-cli/node_modules/babel-loader/lib??ref--0!./routes/connect-three.js\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return connect_three_ConnectThreeRoute; });\n\n\nfunction connect_three__classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction connect_three__possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction connect_three__inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\n\n\n\n\n\nvar connect_three_ConnectThreeRoute = function (_Component) {\n  connect_three__inherits(ConnectThreeRoute, _Component);\n\n  function ConnectThreeRoute() {\n    connect_three__classCallCheck(this, ConnectThreeRoute);\n\n    var _this = connect_three__possibleConstructorReturn(this, _Component.call(this));\n\n    _this.playFor = {};\n    _this.state = {\n      board: null,\n      isLoading: true,\n      connectionError: null\n    };\n    return _this;\n  }\n\n  ConnectThreeRoute.prototype.componentWillMount = function componentWillMount() {\n    var _this2 = this;\n\n    this.pa = new productive_abuser[\"a\" /* default */](config[\"a\" /* default */]);\n    this.pa.connect(function (ev) {\n      return _this2.onProductiveMessage(ev);\n    }).then(function () {\n      return _this2.pa.fetchChannels();\n    }).then(function (channels) {\n      return channels.find(function (channel) {\n        return channel.tags.includes('productive-abuser');\n      });\n    }).then(function (channel) {\n      return _this2.channel = channel;\n    }).then(function () {\n      return _this2.setState({ isLoading: false, connectionError: null });\n    }).catch(function (err) {\n      if (err instanceof Error) {\n        throw err;\n      }\n      alert(err);\n      _this2.setState({ isLoading: false, connectionError: err.toString() });\n    });\n  };\n\n  ConnectThreeRoute.prototype.componentWillUnmount = function componentWillUnmount() {\n    this.pa.disconnect();\n  };\n\n  ConnectThreeRoute.prototype.onProductiveMessage = function onProductiveMessage(ev) {\n    Object(routing_message_handlers[\"a\" /* default */])(ev);\n\n    if (!this.channel || ev.channelId !== this.channel.id) {\n      this.pa.fetchChannel(ev.channelId).then(function (channel) {\n        if (channel.tags.includes('snake')) {\n          Object(preact_router_es[\"b\" /* route */])('/snake');\n        }\n      });\n      return;\n    }\n\n    var msg = ev.text.toLowerCase();\n    var num = parseInt(msg, 10);\n    if (msg.indexOf('play') >= 0 && msg.indexOf('connect three with') >= 0) {\n      var p2 = ev.text.split('connect three with')[1].trim();\n      var p1 = (ev.person.firstName + ' ' + ev.person.lastName).trim();\n\n      if (p1 && p2) {\n        this.playFor[p1] = connectThree(p1, p2);\n        this.playFor[p2] = this.playFor[p1];\n\n        if (!this.state.p1 && !this.state.p2) {\n          this.setState({ p1: p1, p2: p2 });\n        }\n      }\n    } else if (num > 0 && num < 10) {\n      var p = ev.person.firstName + ' ' + ev.person.lastName;\n\n      if (!this.playFor[p]) {\n        return;\n      }\n\n      var state = this.playFor[p](p, (num - 1) % 3, Math.floor((num - 1) / 3));\n      this.pa.postMessageToChannel(this.channel.id, '<pre>' + state + '</pre>');\n\n      if (p === this.state.p1 || p === this.state.p2) {\n        this.setState({ board: state });\n      }\n    }\n  };\n\n  ConnectThreeRoute.prototype.render = function render(props, _ref) {\n    var board = _ref.board,\n        p1 = _ref.p1,\n        p2 = _ref.p2;\n\n    return Object(preact_min[\"h\"])(connect_three_ConnectThree, {\n      p1: p1,\n      p2: p2,\n      board: board\n    });\n  };\n\n  return ConnectThreeRoute;\n}(preact_min[\"Component\"]);\n\n\n\n/***/ }),\n\n/***/ \"BmyT\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\nmodule.exports = {\"connectThree\":\"connectThree__6b6z7\",\"connectThree_p1\":\"connectThree_p1__2DXbQ\",\"connectThree_p2\":\"connectThree_p2__1II49\",\"connectThree_board\":\"connectThree_board__1Rc0E\"};\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// route-connect-three.chunk.7cc5e.js","export default function connectThree(p1, p2) {\n  const g = [[0, 0, 0], [0, 0, 0], [0, 0, 0]];\n  const sign = {0: ' '};\n  sign[p1] = 'X';\n  sign[p2] = 'O';\n\n  let currentPlayer = p1;\n  let winner;\n\n  function isPlayerWinner(p) {\n    return (g[0][0] === p && g[0][1] === p && g[0][2] === p) || (g[1][0] === p && g[1][1] === p && g[1][2] === p) || (g[2][0] === p && g[2][1] === p && g[2][2] === p) || (g[0][0] === p && g[1][0] === p && g[2][0] === p) || (g[0][1] === p && g[1][1] === p && g[2][1] === p) || (g[0][2] === p && g[1][2] === p && g[2][2] === p) || (g[0][0] === p && g[1][1] === p && g[2][2] === p) || (g[0][2] === p && g[1][1] === p && g[2][0] === p);\n  }\n\n  return function play(p, y, x) {\n    if (g[x][y] === 0 && p === currentPlayer && !winner) {\n      g[x][y] = p;\n      currentPlayer = (p === p1 ? p2 : p1);\n    }\n\n    winner = isPlayerWinner(p1) ? p1 : (isPlayerWinner(p2) && p2);\n    if (winner) {\n      return `Winner is ${winner}`;\n    } else if (!g.reduce((hasZero, row) => hasZero || row.includes(0), false)) {\n      return 'Nobody wins';\n    }\n\n    return `-------\\n${g.map((row) => (`|${row.map((cell) => sign[cell]).join('|')}|`)).join('\\n')}\\n-------`;\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./lib/connect-three.js","import {h, Component} from 'preact';\nimport s from './style';\n\nexport default class ConnectThree extends Component {\n  render({board, p1, p2}) {\n    return (\n      <div class={s.connectThree}>\n        {p1 && (<div class={s.connectThree_p1}> {p1} <br /> X </div>)}\n        {p2 && (<div class={s.connectThree_p2}> {p2} <br /> O </div>)}\n\n        {board ? (\n          <div class={s.connectThree_board}>\n            <pre>{board}</pre>\n          </div>\n        ) : (\n          <h1> Connect three </h1>\n        )}\n      </div>\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./components/connect-three/index.js","import {h, Component} from 'preact';\nimport {route} from 'preact-router';\nimport ConnectThree from '../components/connect-three';\nimport config from '../lib/config';\nimport ProductiveAbuser from '../lib/productive-abuser';\nimport connectThree from '../lib/connect-three';\nimport handleMessageForRouting from '../lib/routing-message-handlers';\n\nexport default class ConnectThreeRoute extends Component {\n  constructor() {\n    super();\n    this.playFor = {};\n    this.state = {\n      board: null,\n      isLoading: true,\n      connectionError: null\n    };\n  }\n\n  componentWillMount() {\n    this.pa = new ProductiveAbuser(config);\n    this.pa.connect((ev) => this.onProductiveMessage(ev))\n      .then(() => this.pa.fetchChannels())\n      .then((channels) => channels.find((channel) => channel.tags.includes('productive-abuser')))\n      .then((channel) => (this.channel = channel))\n      .then(() => this.setState({isLoading: false, connectionError: null}))\n      .catch((err) => {\n        if (err instanceof Error) {\n          throw err;\n        }\n        alert(err);\n        this.setState({isLoading: false, connectionError: err.toString()});\n      });\n  }\n\n  componentWillUnmount() {\n    this.pa.disconnect();\n  }\n\n  onProductiveMessage(ev) {\n    handleMessageForRouting(ev);\n\n    if (!this.channel || ev.channelId !== this.channel.id) {\n      this.pa.fetchChannel(ev.channelId).then((channel) => {\n        if (channel.tags.includes('snake')) {\n          route('/snake');\n        }\n      });\n      return;\n    }\n\n    const msg = ev.text.toLowerCase();\n    const num = parseInt(msg, 10);\n    if (msg.indexOf('play') >= 0 && msg.indexOf('connect three with') >= 0) {\n      const p2 = ev.text.split('connect three with')[1].trim();\n      const p1 = `${ev.person.firstName} ${ev.person.lastName}`.trim();\n\n      if (p1 && p2) {\n        this.playFor[p1] = connectThree(p1, p2);\n        this.playFor[p2] = this.playFor[p1];\n\n        if (!this.state.p1 && !this.state.p2) {\n          this.setState({p1, p2});\n        }\n      }\n    } else if (num > 0 && num < 10) {\n      const p = `${ev.person.firstName} ${ev.person.lastName}`;\n\n      if (!this.playFor[p]) {\n        return;\n      }\n\n      const state = this.playFor[p](p, (num - 1) % 3, Math.floor((num - 1) / 3));\n      this.pa.postMessageToChannel(this.channel.id, `<pre>${state}</pre>`);\n\n      if (p === this.state.p1 || p === this.state.p2) {\n        this.setState({board: state});\n      }\n    }\n  }\n\n  render(props, {board, p1, p2}) {\n    return (\n      <ConnectThree\n        p1={p1}\n        p2={p2}\n        board={board}\n      />\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./routes/connect-three.js","// removed by extract-text-webpack-plugin\nmodule.exports = {\"connectThree\":\"connectThree__6b6z7\",\"connectThree_p1\":\"connectThree_p1__2DXbQ\",\"connectThree_p2\":\"connectThree_p2__1II49\",\"connectThree_board\":\"connectThree_board__1Rc0E\"};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./components/connect-three/style.less\n// module id = BmyT\n// module chunks = 4"],"sourceRoot":""}