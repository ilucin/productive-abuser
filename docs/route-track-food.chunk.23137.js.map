{"version":3,"sources":["webpack:///route-track-food.chunk.23137.js","webpack:///./components/track-food/style.less?3e9c","webpack:///./components/track-food/index.js","webpack:///./routes/track-food.js","webpack:///./lib/helpers.js"],"names":["webpackJsonp","92Xb","module","exports","trackFood","trackFood_box","trackFood_title","trackFood_tokenError","trackFood_tokenInput","trackFood_person","hwI/","__webpack_exports__","__webpack_require__","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","TypeError","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","track_food__classCallCheck","instance","Constructor","track_food__possibleConstructorReturn","track_food__inherits","defineProperty","preact_min","config","helpers","pong_loader","style","style_default","n","_ref2","track_food_TrackFood","_Component","TrackFood","this","apply","arguments","onInputKeyup","ev","String","which","keyCode","props","applyToken","token","render","_ref","person","isLoading","isTokenError","updateToken","isConnecting","connectionError","class","a","type","disabled","onInput","onKeyup","placeholder","firstName","productive_abuser","routing_message_handlers","d","track_food_TrackFoodRoute","_extends","assign","target","i","length","source","key","hasOwnProperty","TrackFoodRoute","_this","state","localStorage","getItem","componentWillMount","_this2","pa","connect","onProductiveMessage","then","setState","catch","componentWillUnmount","disconnect","paPerson","onTokenChange","onTokenApply","_this3","setItem","fetchTokenPerson","id","text","indexOf","food","split","trim","query","method","headers","Headers","Accept","Content-Type","body","JSON","stringify","data","attributes","time","billable_time","date","Date","toJSON","note","relationships","service","foodServiceId","approver","task","alert","err","tyed","action","ctx","actionName","_len","curriedArgs","Array","_key","_actions","Error","_len2","args","_key2","concat","shuffleArray","inArray","array","slice","counter","index","Math","floor","random","temp","without","arr","item","idx","res","splice"],"mappings":"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","file":"route-track-food.chunk.23137.js","sourcesContent":["webpackJsonp([1],{\n\n/***/ \"92Xb\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\nmodule.exports = {\"trackFood\":\"trackFood__GNzHl\",\"trackFood_box\":\"trackFood_box__2nyWe\",\"trackFood_title\":\"trackFood_title__2yxZ2\",\"trackFood_tokenError\":\"trackFood_tokenError__1qN39\",\"trackFood_tokenInput\":\"trackFood_tokenInput__h0YS6\",\"trackFood_person\":\"trackFood_person__3g9lS\"};\n\n/***/ }),\n\n/***/ \"hwI/\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n\n// EXTERNAL MODULE: ../node_modules/preact/dist/preact.min.js\nvar preact_min = __webpack_require__(\"KM04\");\nvar preact_min_default = /*#__PURE__*/__webpack_require__.n(preact_min);\n\n// EXTERNAL MODULE: ./lib/config.js\nvar config = __webpack_require__(\"5Iuc\");\n\n// EXTERNAL MODULE: ./lib/helpers.js\nvar helpers = __webpack_require__(\"tyed\");\n\n// EXTERNAL MODULE: ./components/pong-loader/index.js\nvar pong_loader = __webpack_require__(\"6whb\");\n\n// EXTERNAL MODULE: ./components/track-food/style.less\nvar style = __webpack_require__(\"92Xb\");\nvar style_default = /*#__PURE__*/__webpack_require__.n(style);\n\n// CONCATENATED MODULE: ./components/track-food/index.js\n\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\n\n\nvar _ref2 = Object(preact_min[\"h\"])(pong_loader[\"a\" /* default */], null);\n\nvar track_food_TrackFood = function (_Component) {\n  _inherits(TrackFood, _Component);\n\n  function TrackFood() {\n    _classCallCheck(this, TrackFood);\n\n    return _possibleConstructorReturn(this, _Component.apply(this, arguments));\n  }\n\n  TrackFood.prototype.onInputKeyup = function onInputKeyup(ev) {\n    var charCode = String(ev.which || ev.keyCode);\n    if (charCode === '13') {\n      this.props.applyToken(this.props.token);\n    }\n  };\n\n  TrackFood.prototype.render = function render(_ref) {\n    var token = _ref.token,\n        person = _ref.person,\n        isLoading = _ref.isLoading,\n        isTokenError = _ref.isTokenError,\n        updateToken = _ref.updateToken,\n        applyToken = _ref.applyToken,\n        isConnecting = _ref.isConnecting,\n        connectionError = _ref.connectionError;\n\n    if (isConnecting) {\n      return Object(preact_min[\"h\"])(\n        'section',\n        { 'class': style_default.a.trackFood },\n        Object(preact_min[\"h\"])(\n          'div',\n          { 'class': style_default.a.trackFood_box },\n          _ref2\n        )\n      );\n    }\n\n    return Object(preact_min[\"h\"])(\n      'section',\n      { 'class': style_default.a.trackFood },\n      Object(preact_min[\"h\"])(\n        'div',\n        { 'class': style_default.a.trackFood_box },\n        Object(preact_min[\"h\"])(\n          'div',\n          { 'class': style_default.a.trackFood_title },\n          ' Food Tracker 2000 Pro '\n        ),\n        Object(preact_min[\"h\"])('input', {\n          'class': style_default.a.trackFood_tokenInput,\n          type: 'password',\n          value: token || '',\n          disabled: !!person || isLoading,\n          onInput: updateToken,\n          onKeyup: Object(helpers[\"a\" /* action */])(this, 'onInputKeyup'),\n          placeholder: 'Write your token here'\n        }),\n        connectionError && Object(preact_min[\"h\"])(\n          'div',\n          { 'class': style_default.a.trackFood_tokenError },\n          connectionError\n        ),\n        isTokenError && Object(preact_min[\"h\"])(\n          'div',\n          { 'class': style_default.a.trackFood_tokenError },\n          'Token error'\n        ),\n        person && Object(preact_min[\"h\"])(\n          'div',\n          { 'class': style_default.a.trackFood_person },\n          'Hi ',\n          person.firstName,\n          '! I am here to track your food.'\n        )\n      )\n    );\n  };\n\n  return TrackFood;\n}(preact_min[\"Component\"]);\n\n\n// EXTERNAL MODULE: ./lib/productive-abuser.js\nvar productive_abuser = __webpack_require__(\"+UHd\");\n\n// EXTERNAL MODULE: ./lib/routing-message-handlers.js\nvar routing_message_handlers = __webpack_require__(\"D9/9\");\n\n// CONCATENATED MODULE: /usr/local/lib/node_modules/preact-cli/node_modules/babel-loader/lib??ref--0!./routes/track-food.js\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return track_food_TrackFoodRoute; });\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\n\n\nfunction track_food__classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction track_food__possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction track_food__inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\n\n\n\n\nvar track_food_TrackFoodRoute = function (_Component) {\n  track_food__inherits(TrackFoodRoute, _Component);\n\n  function TrackFoodRoute() {\n    track_food__classCallCheck(this, TrackFoodRoute);\n\n    var _this = track_food__possibleConstructorReturn(this, _Component.call(this));\n\n    _this.state = {\n      token: localStorage.getItem('trackFoodToken'),\n      isLoading: false,\n      isTokenError: false,\n      person: null,\n      isConnecting: true,\n      connectionError: null\n    };\n    return _this;\n  }\n\n  TrackFoodRoute.prototype.componentWillMount = function componentWillMount() {\n    var _this2 = this;\n\n    this.pa = new productive_abuser[\"a\" /* default */](config[\"a\" /* default */]);\n    this.pa.connect(function (ev) {\n      return _this2.onProductiveMessage(ev);\n    }).then(function (person) {\n      return _this2.setState({ isConnecting: false, connectionError: null });\n    }).catch(function (connectionError) {\n      return _this2.setState({ isConnecting: false, connectionError: connectionError });\n    });\n  };\n\n  TrackFoodRoute.prototype.componentWillUnmount = function componentWillUnmount() {\n    if (this.pa) {\n      this.pa.disconnect();\n    }\n\n    if (this.paPerson) {\n      this.paPerson.disconnect();\n    }\n  };\n\n  TrackFoodRoute.prototype.onTokenChange = function onTokenChange(ev) {\n    this.setState({ token: ev.target.value });\n  };\n\n  TrackFoodRoute.prototype.onTokenApply = function onTokenApply() {\n    var _this3 = this;\n\n    this.paPerson = new productive_abuser[\"a\" /* default */](_extends({}, config[\"a\" /* default */], { token: this.state.token }));\n    this.setState({ isLoading: true });\n    localStorage.setItem('trackFoodToken', this.state.token);\n\n    this.paPerson.fetchTokenPerson().then(function (person) {\n      return _this3.setState({ person: person, isLoading: false, isTokenError: false });\n    }).catch(function () {\n      return _this3.setState({ isLoading: false, isTokenError: true });\n    });\n  };\n\n  TrackFoodRoute.prototype.onProductiveMessage = function onProductiveMessage(ev) {\n    Object(routing_message_handlers[\"a\" /* default */])(ev);\n\n    var person = this.state.person;\n    if (person && ev.person.id === person.id && ev.text.indexOf('Danas sam jeo') === 0) {\n      var food = ev.text.split('Danas sam jeo')[1].trim();\n\n      this.paPerson.query('time_entries', {}, {\n        method: 'POST',\n        headers: new Headers({\n          'Accept': 'application/vnd.api+json',\n          'Content-Type': 'application/vnd.api+json; charset=utf-8'\n        }),\n        body: JSON.stringify({\n          data: {\n            type: 'time-entries',\n            attributes: {\n              time: 30,\n              billable_time: 30,\n              date: new Date().toJSON().split('T')[0],\n              note: food\n            },\n            relationships: {\n              person: { data: { type: 'people', id: person.id } },\n              service: { data: { type: 'services', id: config[\"a\" /* default */].foodServiceId } },\n              approver: { data: null },\n              task: { data: null }\n            }\n          }\n        })\n      }).then(function () {\n        return alert(food);\n      }).catch(function (err) {\n        return alert(err);\n      });\n    }\n  };\n\n  TrackFoodRoute.prototype.render = function render(props, _ref) {\n    var token = _ref.token,\n        person = _ref.person,\n        isLoading = _ref.isLoading,\n        isTokenError = _ref.isTokenError,\n        isConnecting = _ref.isConnecting,\n        connectionError = _ref.connectionError;\n\n    return Object(preact_min[\"h\"])(track_food_TrackFood, {\n      token: token,\n      person: person,\n      isLoading: isLoading,\n      isTokenError: isTokenError,\n      isConnecting: isConnecting,\n      connectionError: connectionError,\n      updateToken: Object(helpers[\"a\" /* action */])(this, 'onTokenChange'),\n      applyToken: Object(helpers[\"a\" /* action */])(this, 'onTokenApply')\n    });\n  };\n\n  return TrackFoodRoute;\n}(preact_min[\"Component\"]);\n\n\n\n/***/ }),\n\n/***/ \"tyed\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = action;\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = shuffleArray;\n/* harmony export (immutable) */ __webpack_exports__[\"c\"] = without;\nfunction action(ctx, actionName) {\n  for (var _len = arguments.length, curriedArgs = Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n    curriedArgs[_key - 2] = arguments[_key];\n  }\n\n  ctx._actions = ctx._actions || {};\n\n  if (!ctx._actions[actionName]) {\n    if (!ctx[actionName]) {\n      throw new Error(\"Method \\\"\" + actionName + \"\\\" not found on component\");\n    }\n    ctx._actions[actionName] = function () {\n      for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      return ctx[actionName].apply(ctx, curriedArgs.concat(args));\n    };\n  }\n\n  return ctx._actions[actionName];\n}\n\nfunction shuffleArray(inArray) {\n  var array = inArray.slice();\n  var counter = array.length;\n\n  while (counter > 0) {\n    var index = Math.floor(Math.random() * counter);\n    counter--;\n    var temp = array[counter];\n    array[counter] = array[index];\n    array[index] = temp;\n  }\n\n  return array;\n}\n\nfunction without(arr, item) {\n  var idx = arr.indexOf(item);\n  if (idx >= 0) {\n    var res = arr.slice();\n    res.splice(idx, 1);\n    return res;\n  }\n  return arr.slice();\n}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// route-track-food.chunk.23137.js","// removed by extract-text-webpack-plugin\nmodule.exports = {\"trackFood\":\"trackFood__GNzHl\",\"trackFood_box\":\"trackFood_box__2nyWe\",\"trackFood_title\":\"trackFood_title__2yxZ2\",\"trackFood_tokenError\":\"trackFood_tokenError__1qN39\",\"trackFood_tokenInput\":\"trackFood_tokenInput__h0YS6\",\"trackFood_person\":\"trackFood_person__3g9lS\"};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./components/track-food/style.less\n// module id = 92Xb\n// module chunks = 1","import {h, Component} from 'preact';\nimport {action} from '../../lib/helpers';\nimport PongLoader from '../pong-loader';\nimport s from './style';\n\nexport default class TrackFood extends Component {\n  onInputKeyup(ev) {\n    var charCode = String(ev.which || ev.keyCode);\n    if (charCode === '13') {\n      this.props.applyToken(this.props.token);\n    }\n  }\n\n  render({token, person, isLoading, isTokenError, updateToken, applyToken, isConnecting, connectionError}) {\n    if (isConnecting) {\n      return (\n        <section class={s.trackFood}>\n          <div class={s.trackFood_box}>\n            <PongLoader />\n          </div>\n        </section>\n      );\n    }\n\n    return (\n      <section class={s.trackFood}>\n        <div class={s.trackFood_box}>\n          <div class={s.trackFood_title}> Food Tracker 2000 Pro </div>\n\n          <input\n            class={s.trackFood_tokenInput}\n            type='password'\n            value={token || ''}\n            disabled={!!person || isLoading}\n            onInput={updateToken}\n            onKeyup={action(this, 'onInputKeyup')}\n            placeholder='Write your token here'\n          />\n\n          {connectionError &&\n            <div class={s.trackFood_tokenError}>\n              {connectionError}\n            </div>\n          }\n\n          {isTokenError &&\n            <div class={s.trackFood_tokenError}>\n              Token error\n            </div>\n          }\n\n          {person &&\n            <div class={s.trackFood_person}>\n              Hi {person.firstName}! I am here to track your food.\n            </div>\n          }\n        </div>\n      </section>\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./components/track-food/index.js","import {h, Component} from 'preact';\nimport config from '../lib/config';\nimport TrackFood from '../components/track-food';\nimport ProductiveAbuser from '../lib/productive-abuser';\nimport {action} from '../lib/helpers';\nimport handleMessageForRouting from '../lib/routing-message-handlers';\n\nexport default class TrackFoodRoute extends Component {\n  constructor() {\n    super();\n    this.state = {\n      token: localStorage.getItem('trackFoodToken'),\n      isLoading: false,\n      isTokenError: false,\n      person: null,\n      isConnecting: true,\n      connectionError: null\n    };\n  }\n\n  componentWillMount() {\n    this.pa = new ProductiveAbuser(config);\n    this.pa.connect((ev) => this.onProductiveMessage(ev))\n      .then((person) => this.setState({isConnecting: false, connectionError: null}))\n      .catch((connectionError) => this.setState({isConnecting: false, connectionError}));\n  }\n\n  componentWillUnmount() {\n    if (this.pa) {\n      this.pa.disconnect();\n    }\n\n    if (this.paPerson) {\n      this.paPerson.disconnect();\n    }\n  }\n\n  onTokenChange(ev) {\n    this.setState({token: ev.target.value});\n  }\n\n  onTokenApply() {\n    this.paPerson = new ProductiveAbuser(Object.assign({}, config, {token: this.state.token}));\n    this.setState({isLoading: true});\n    localStorage.setItem('trackFoodToken', this.state.token);\n\n    this.paPerson.fetchTokenPerson()\n      .then((person) => this.setState({person, isLoading: false, isTokenError: false}))\n      .catch(() => this.setState({isLoading: false, isTokenError: true}));\n  }\n\n  onProductiveMessage(ev) {\n    handleMessageForRouting(ev);\n\n    const person = this.state.person;\n    if (person && ev.person.id === person.id && ev.text.indexOf('Danas sam jeo') === 0) {\n      const food = ev.text.split('Danas sam jeo')[1].trim();\n\n      this.paPerson.query('time_entries', {}, {\n        method: 'POST',\n        headers: new Headers({\n          'Accept': 'application/vnd.api+json',\n          'Content-Type': 'application/vnd.api+json; charset=utf-8'\n        }),\n        body: JSON.stringify({\n          data: {\n            type: 'time-entries',\n            attributes: {\n              time: 30,\n              billable_time: 30,\n              date: new Date().toJSON().split('T')[0],\n              note: food\n            },\n            relationships: {\n              person: {data: {type: 'people', id: person.id}},\n              service: {data: {type: 'services', id: config.foodServiceId}},\n              approver: {data: null},\n              task: {data: null}\n            }\n          }\n        })\n      }).then(() => alert(food))\n        .catch((err) => alert(err));\n    }\n  }\n\n  render(props, {token, person, isLoading, isTokenError, isConnecting, connectionError}) {\n    return (\n      <TrackFood\n        token={token}\n        person={person}\n        isLoading={isLoading}\n        isTokenError={isTokenError}\n        isConnecting={isConnecting}\n        connectionError={connectionError}\n        updateToken={action(this, 'onTokenChange')}\n        applyToken={action(this, 'onTokenApply')}\n      />\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./routes/track-food.js","export function action(ctx, actionName, ...curriedArgs) {\n  ctx._actions = ctx._actions || {};\n\n  if (!ctx._actions[actionName]) {\n    if (!ctx[actionName]) {\n      throw new Error(`Method \"${actionName}\" not found on component`);\n    }\n    ctx._actions[actionName] = function(...args) {\n      return ctx[actionName].apply(ctx, curriedArgs.concat(args));\n    };\n  }\n\n  return ctx._actions[actionName];\n}\n\nexport function shuffleArray(inArray) {\n  const array = inArray.slice();\n  let counter = array.length;\n\n  while (counter > 0) {\n    const index = Math.floor(Math.random() * counter);\n    counter--;\n    const temp = array[counter];\n    array[counter] = array[index];\n    array[index] = temp;\n  }\n\n  return array;\n}\n\nexport function without(arr, item) {\n  const idx = arr.indexOf(item);\n  if (idx >= 0) {\n    const res = arr.slice();\n    res.splice(idx, 1);\n    return res;\n  }\n  return arr.slice();\n}\n\n\n\n// WEBPACK FOOTER //\n// ./lib/helpers.js"],"sourceRoot":""}